#!/usr/bin/python
# -*- coding: utf-8 -*-

#
# Serial send and receive test file
#
# @name: serial.test.py
# 
# @date: 2012-10-07
#
# @version: 0.0.1
#
# @description: Serial send and receive test file
#

import serial
import time
import sys

s = serial.Serial("/dev/tty.usbmodemfa131", 57600, timeout=2)

def binSplitter(b):
  return [b[8*i:8*(i+1)] for i in xrange(len(b)//8)]


image = [
0xCC5B, 0xCC3B, 0xC41B, 0xC3FA, 0xC3FA, 0xC3BA, 0xBBB9, 0xBB99, 0xBB79, 0xBB78, 0xB358, 0xB338, 0xB318, 0xB2F7, 0xAAF7, 0xAAF7,
0xCC3B, 0xC41B, 0xC3FA, 0xC3FA, 0xC3BA, 0xBBB9, 0xBB99, 0xBB79, 0xB378, 0xB358, 0xB338, 0xB318, 0xB317, 0xAAF7, 0xAAF7, 0xAAD7,
0xC41B, 0xC3FA, 0xC3DA, 0xC3DA, 0xBBB9, 0xBB99, 0xBB79, 0xB358, 0xB358, 0xB338, 0xB338, 0xAB17, 0xAAF7, 0xAAF7, 0xAAD7, 0xAAD7,
0xC41A, 0xC3FA, 0xC3DA, 0xBBB9, 0xBB99, 0xBB79, 0xBB78, 0xB358, 0xB338, 0xB318, 0xB317, 0xAAF7, 0xAAF7, 0xAAD7, 0xAAD7, 0xAAD7,
0xC3FA, 0xC3DA, 0xBBB9, 0xBB99, 0xBB79, 0xBB78, 0xB358, 0xB338, 0xB338, 0xB317, 0xAAF7, 0xAAF7, 0xAAD7, 0xAAD7, 0xAAD7, 0xAAB6,
0xC3DA, 0xBBB9, 0xBB99, 0xBB79, 0xBB78, 0xB358, 0xB338, 0xB338, 0xB317, 0xB2F7, 0xAAF7, 0xAAD7, 0xAAD7, 0xAAB6, 0xAAB6, 0xAA96,
0xBBBA, 0xBB99, 0xBB99, 0xBB78, 0xB358, 0xB338, 0xB338, 0xB317, 0xAAF7, 0xAAF7, 0xAAF7, 0xAAD7, 0xAAB6, 0xAAB6, 0xAA96, 0xA296,
0xBBB9, 0xBB79, 0xBB78, 0xB358, 0xB338, 0xB338, 0xB317, 0xB317, 0xAAF7, 0xAAD7, 0xAAD7, 0xAAD7, 0xAAB6, 0xAAB6, 0xA296, 0xA296,
0xBB79, 0xBB78, 0xB358, 0xB358, 0xB338, 0xB317, 0xB317, 0xAAF7, 0xAAF7, 0xAAD7, 0xAAD7, 0xAAB6, 0xAAB6, 0xA296, 0xA276, 0xA275,
0xBB79, 0xB358, 0xB338, 0xB338, 0xB318, 0xB317, 0xAAF7, 0xAAD7, 0xAAD7, 0xAAD7, 0xAAB6, 0xAAB6, 0xA296, 0xA296, 0xA275, 0xA255,
0xB358, 0xB338, 0xB338, 0xB318, 0xB2F7, 0xAAF7, 0xAAD7, 0xAAD7, 0xAAD6, 0xAAB6, 0xAAB6, 0xA296, 0xA296, 0xA275, 0xA255, 0x9A35,
0xB358, 0xB338, 0xB318, 0xB2F7, 0xAAF7, 0xAAF7, 0xAAD7, 0xAAD7, 0xAAD6, 0xAAB6, 0xA296, 0xA296, 0xA276, 0xA255, 0x9A55, 0x9A34,
0xB338, 0xB337, 0xB317, 0xAAF7, 0xAAF7, 0xAAD7, 0xAAD6, 0xAAD6, 0xAAB6, 0xAA96, 0xA296, 0xA275, 0xA255, 0x9A35, 0x9A35, 0x9A14,
0xB338, 0xB317, 0xAAF7, 0xAAF7, 0xAAF7, 0xAAD7, 0xAAD6, 0xAAB6, 0xAA96, 0xA296, 0xA276, 0xA255, 0xA255, 0x9A35, 0x9A14, 0x99F4,
0xB317, 0xB2F7, 0xAAF7, 0xAAD7, 0xAAD7, 0xAAD6, 0xAAB6, 0xA296, 0xA296, 0xA276, 0xA275, 0xA255, 0x9A35, 0x9A14, 0x99F4, 0x99D4,
0xB317, 0xAAF7, 0xAAD7, 0xAAD7, 0xAAD6, 0xAAB6, 0xAAB6, 0xA296, 0xA276, 0xA275, 0xA255, 0x9A35, 0x9A14, 0x99F4, 0x91D4, 0x91B3,
]

time.sleep(3)

s.flush()

print("Initiating image transfer")
s.write('1')
print(s.readline())

time.sleep(2)

print("Starting datatransfer")
time.sleep(0.5)

for integer in image:
  s.write(str(integer) + '\n')
  print(bin(integer))
  print(s.readline())


time.sleep(0.5)
print("Ending datatransfer")

s.close()
